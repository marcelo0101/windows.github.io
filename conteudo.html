<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="index.css">
    <title>PowerShell</title>
</head>
<body>

    <h1>PowerShell</h1>

    <p>
        <h2>O qué PowerShell?</h2>
        <ul>

            <li>  Com PowerShell se pode criar scripts sem que seja archivos de lote (antigo .BAT) </li>
            <li> Comparte estrutura de PERL uma linguagem de alto nivel. </li>
            <li> Requer Microsoft .NET framework</li>
            <li> Desde 2016 Micrsoft publicou em Github o código para se integrar com os sistemas GNU/Linux e MAC OSX</li>
            <li> Temos varios comando ou ordens qye são chamados  <strong>cmdlets</strong></li>

        </ul>

        <h2>Como executar PowerShell?</h2>
        <ul>

            <li> Interface de comandos PowerShell </li>
            <li> Windows PowerShell ISE (seria como uma IDE para programar em PowerShell)</li>
            <li> Execução de archivos .ps1</li>
   
        </ul>

        <h2>Estrutura de comandos</h2>
        <ul>

            <li> Os nomes de todos os <strong>cmdlets</strong> seguem um padrão comum, formado por um verbo um traço e um nome singular (ex.: Get-Help)</li>
            <li> Windows PowerShell não distingue entra maiúscula e minuscula, recomendação seguir o padrão</li>
            <li> Se usamos ISE ambiente de desenvolvimento podemos ter a ajuda do autocompletar</li>
            <li> Argumentos e Operandos - ex.: <strong> cp -R origem destino </strong>  (-R argumento para modificar o comportamento padrão deste comando
                e copiar de forma recursiva ou seja todos as subpastas e arquivos e para copiar precisamos informar a origem e destino)</li>
            <li> Opcionais e Obrigatórios</li>
   
        </ul>


        
        <h2>Atenção com os escripts</h2>
        <ul>

            <li> Segurança na execução de scripts</li>
            <li> Devido a ser um recurso muito potente deve ser controlado (pode criar varias coisas inclusive criar politica e usuarios no AD </li>
            <li> Usuarios sem experiência </li>
            
   
        </ul>

        <h2>Quatro niveis de Permissão</h2>
        <ul>

            <li> <strong>Restricted:</strong> Neste nivel não se permite a execução de scripts, apenas em modo interativo, esta é a opção predeterminada </li>
            <li> <strong>AllSigned:</strong> Neste opção os scripts precisam estar autenticados, antes de poder executar. É a opção mais restritiva </li>
            <li> <strong>RemoteSigned:</strong> Neste caso precisam estar autenticados scripts de um local remoto, por exemplos os que baixamos.</li>
            <li><strong>Unrestricted: </strong> Se esta opção estiver selecionada vai executar qualquer script de qualquer origem. Se trata da opção menos recomendada.</li>
            
   
        </ul>
       

        <hr>

        <h2>Comandos</h2>

 

        <p>
            <strong>Get-Command</strong><br>
            Get-Command -CommandType cmdlet | Measure-Object  <br>
    
            <pre>
                Numero de comando atual que podemos usar no PowerShell. 

                Count    : 693
                Average  : 
                Sum      : 
                Maximum  : 
                Minimum  : 
                Property : 
    
            </pre>

        </p>

        <hr>

        <p>
            <strong>DIR no PowerShell é Get-ChildItem</strong>
        </p>

        <hr>

        <p>
            <strong>Get-Help </strong> <br>
            Comando pata pedir ajuda para outro comando por exemplo: <br>
            <strong> Get-Help Get-ChildItem</strong> <br>

            Se necessitamos ajuda on´line com exemplos podemos usar: <br>
             <strong>Get-help -Online Get-ChildItem</strong>
        
        </p>

        <hr>

        <p>
           Podemos baixar o arquivo de ajuda On-line se for necessário <br>
            <strong>Update-Help -Module Microsoft.PowerShell*</strong> <br>

            Se agora solicitamos ajuda de Get-ChildItem será mais completa <br>
            <strong>Get-Help Get-ChildItem -Detailed</strong> <br>
            Com isso atualizamos a ajuda local com o que temos de mais recente na internet <br>

            Podemos solicitar exemplo: <br>
            <strong>Get-Help Get-ChildItem -Examples </strong> <br>
            Se queremos informação detalhada de cada argumento do comando: <br>
            <strong>Get-Help Get-ChildItem -Full</strong>

        </p>


        <hr>

        <p>
            Saber que tipo de politica temos altualmente das quatro opções que vimos. <br>
            <strong>Get-ExecutionPolicy</strong> <br>
            <br>
            Para mudar a politica, sempre executamos PowerShell como administrador <br>
            <strong>Set-ExecutionPolicy RemoteSigned</strong> <br>
            <br>
            Precisamos executar PowerShell como administrador para mudar a configuração.

            <pre>
                PS C:\Windows\system32> Set-ExecutionPolicy RemoteSigned

                Execution Policy Change
                The execution policy helps protect you from scripts that you do not trust. Changing the execution policy might expose
                you to the security risks described in the about_Execution_Policies help topic at
                https:/go.microsoft.com/fwlink/?LinkID=135170. Do you want to change the execution policy?
                [Y] Yes  [A] Yes to All  [N] No  [L] No to All  [S] Suspend  [?] Help (default is "N"): y
                PS C:\Windows\system32> Get-ExecutionPolicy
                RemoteSigned
            </pre>

        </p>

        <hr>

        <h2>Primeiro Script</h2>

        <p>
            Guardaremos o arquivo com a extensão -ps1 <br>

            Write-Host "Hola Amigos!!"
            Write-Host "Isto é um script PowerShell"
            pause

            <pre>
                PS C:\> cd jss
                PS C:\jss> .\primeiroScript.ps1
                Hola Amigos!!
                Isto é um script PowerShell
                PS C:\jss> ./primeiroScript.ps1
                Hola Amigos!!
                Isto é um script PowerShell

                PS C:\jss> ./primeiroScript.ps1
                Hola Amigos!!
                Isto é um script PowerShell
                Press Enter to continue...: (adicionai a pause)


            </pre>

            <h4>Caminho para abrir os scripts com PowerShell ISE</h4>
            C:\Windows\System32\WindowsPowerShell\v1.0\powershell_ise <br>


        </p>

<hr>
        <h2>Varáveis</h2>

        <h2>Conceito de Variável</h2>
        <ul>

            <li> Zona de memoria RAM com um Nome para poder fazer referencia em nosso programa, que o SO reserva, por que outros programas estão usando a mesma memoria RAM.</li>
            <li> Nesta zona ou espaço de memoria podemos escrever e ler </li>
            <li> Memoria reservada para nosso programa ou Scripts</li>
            <li>Proteção SO, assim nenhum outro programa pode alterar nossa variavel, o que está reservado nunhum outro programa pode acessar.</li>
            <li>Nomes Únicos e Inalterados</li>
            
   
        </ul>

<hr>

        <h2>Conceito de Variável Sintax</h2>
        <ul>

            <li> O primeiro caracter deve ser um simbolo de dólar ($)</li>
            <li> Depois podemos utilizar qualquer combinação de letras, números ou simbolos </li>
            <li> Pode-se usar espaço em branco mas neste caso o nome precisa estar entre simbolos de chaves {} Totalmente não recomendado
                se desejar colocar mais de um nome podemos usar underline teste_2
            </li>
            <li> Recomendado nome de variável conciso, curto e autoexplicável</li>
            <li> Primeira variável: <strong>$nome = "João Jorge"</strong> </li>
            <li>Operador de atribuição = a variável <strong>$nome</strong>  neste caso vai conter o que está a direita do sinal de igual. </li>
            <li>O valor de caracteres  tem que estar fechado entre aspas</li>
            <li>boa partica usar nome de variavel sempre em minuscula</li>
            <li> <strong>Modelo Implicito de criar variável</strong> </li>
<hr>
            <li><strong>Modo explicito mais formal</strong> </li>
            <li>Usando o cmdlet New-Variable (New-Variable $nome)</li>
            <li>Ou também (New-Variable -Name $nome)</li>
            <li>Com valor (New-Variable -Name $nome -Value "João Jorge" </li>
                  

        </ul>

        <h2>Constantes</h2>

        <ul>
            <li>As constantes são variáveis que não mudam o valor no tempo de execução</li>
            <li>Si tentamos mudar vai aparecer uma mensagem de erro</li>
            <li> Exemplo explicito: New-Variable -Name $nome -Value "José Jorge" -Option ReadOnly  (Podemos usar para IVA, PI etc)  
                Zona de memoria que o valor não vai ser alterado na execução do nosso script ou programa.
            </li>

            <pre>
                Constante definida com valor 

               <strong>New-Variable nome -Option ReadOnly -value 100 </strong> 

               Se tentamos mudar para pepe 

               $nome = "pepe"

               SAIDA ERROR:

               PS C:\Users\MFJCode Lab>
               New-Variable nome -Option ReadOnly -value 100
               $nome = "pepe"

                Cannot overwrite variable nome because it is read-only or constant.
                At line:3 char:16
                +                $nome = "pepe"
                +                ~~~~~~~~~~~~~~
                    + CategoryInfo          : WriteError: (nome:String) [], SessionStateUnauthorizedAccessException
                    + FullyQualifiedErrorId : VariableNotWritable

            </pre>

            <hr>

            <li>Saber todas as vairaveis que temos definidas (<strong>Get-Variable</strong>)</li>
            
        </ul>

        <pre>
            Temos aqui uma lista de variáveis que não criamos  que já estão criadas no  ambiente 
            Temos duas colunas NAME e VALOR 
            Exemplo a variável HOME tem o valor C:\Users\MFJCode Lab
            Exemplo a variável PSHOME onde temos powershell instalado C:\Windows\System32\WindowsPowerShell\v1.0

            PS C:\Users\MFJCode Lab> Get-Variable

                    Name                           Value
                    ----                           -----
                    $                              get-Variable
                    ?                              True
                    ^                              get-Variable
                    args                           {}
                    ConfirmPreference              High
                    ConsoleFileName
                    DebugPreference                SilentlyContinue
                    Error                          {}
                    ErrorActionPreference          Continue
                    ErrorView                      NormalView
                    ExecutionContext               System.Management.Automation.EngineIntrinsics
                    false                          False
                    FormatEnumerationLimit         4
                    HOME                           C:\Users\MFJCode Lab
                    Host                           System.Management.Automation.Internal.Host.InternalHost
                    InformationPreference          SilentlyContinue
                    input                          System.Collections.ArrayList+ArrayListEnumeratorSimple
                    MaximumAliasCount              4096
                    MaximumDriveCount              4096
                    MaximumErrorCount              256
                    MaximumFunctionCount           4096
                    MaximumHistoryCount            4096
                    MaximumVariableCount           4096
                    MyInvocation                   System.Management.Automation.InvocationInfo
                    NestedPromptLevel              0
                    null
                    OutputEncoding                 System.Text.ASCIIEncoding
                    PID                            11908
                    PROFILE                        C:\Users\MFJCode Lab\Documents\WindowsPowerShell\Microsoft.PowerShell_profile.ps1
                    ProgressPreference             Continue
                    PSBoundParameters              {}
                    PSCommandPath
                    PSCulture                      en-US
                    PSDefaultParameterValues       {}
                    PSEdition                      Desktop
                    PSEmailServer
                    PSHOME                         C:\Windows\System32\WindowsPowerShell\v1.0
                    PSScriptRoot
                    PSSessionApplicationName       wsman
                    PSSessionConfigurationName     http://schemas.microsoft.com/powershell/Microsoft.PowerShell
                    PSSessionOption                System.Management.Automation.Remoting.PSSessionOption
                    PSUICulture                    en-US
                    PSVersionTable                 {PSVersion, PSEdition, PSCompatibleVersions, BuildVersion...}
                    PWD                            C:\Users\MFJCode Lab
                    ShellId                        Microsoft.PowerShell
                    StackTrace
                    true                           True
                    VerbosePreference              SilentlyContinue
                    WarningPreference              Continue
                    WhatIfPreference               False

        </pre>
 
        <hr>

        <h2>Obter valores do Usuario</h2>

        <ul>
            <li>Solicitar os valores que precisamos para o Usuario</li>
            <li>$nome = Read-host "Como você se chama?" </li>
            <li> Se guardará como String </li>
            <li>Não é usado em scripts autoexecutáveis por que vai ficar parado nesta linha até o usuario introduzir a informação solicitada</li>

            <hr>

            <li>Saber todas as vairaveis que temos definidas (<strong>Get-Variable</strong>)</li>
            
        </ul>

        <hr>

        <h2>Imprimir na Tela a informação digitada pelo Usuario</h2>

        <ul>
            <li>Vamos usar para imprimir os valores estáticos ou variáveis</li>

            <pre>
              $nome = Read-host "Como você se chama?"
              Write-Host "Hola" 
              Write-Host $nome

              PS C:\Users\MFJCode Lab> $nome = Read-host "Como você se chama?"
                Write-Host "Hola" 
                Write-Host $nome
                Como você se chama?: Jorge
                Hola
                Jorge
            </pre>
        
            <li>Cada instrucción en líne nueva</li>
            <li>Pratica com a entrada e saida de informação</li>

    
            
        </ul>

        <hr>

        <h2>A memória RAM é que Manda</h2>

        <ul>
            <li>Recurso Limitado </li>        
            <li>Proteção - SO tem que proteger a area reservada para não ser usada por outro programa</li>
            <li>Ajuste Fixo ou ajuste dinâmico  -  Tem variavel que vai ocupar um valor fixo e tem varável que vai ocupar um valor dinâmico dependendo do valor</li>
            <li>Tamanho da Reserva</li>
    
            
        </ul>
    

        <hr>

        <h2>Tipos de Dados</h2>

        <ul>
            <li>STRING - Sequencia de caracteres</li>        
            <li>CHAR - apenas um caracter - Unicode</li>
            <li>INT - Inteiro de 32 bits: -2147483648 a 2147483647</li>
            <li>LONG - Inteiro de 64 bites </li>
            <li>SINGLE - Número Flutuante Decimais de 32 bits</li>
            <li>DOUBLE - Número Flutuante Decimais de 64 bits</li>
            <li>DATETIME - Data e hora: 1 de Janeiro 100 até 31 dezembro 9999</li>  
            <li>BOOL - Valor lógico True ou False</li>  
            <li>ARRAY - Conjunto de valores (Por exemplo armazenar as notas de 30 alunos, não vamos criar para cada aluno uma variavel.
                Criamos um array notas com todas as notas.
            </li>
            <li>HASHTABLE - Objeto que representa uma tabela HASH</li>
            
        </ul>

        <hr>

        <h2>Obter o tipo da Variável</h2>

        <ul>
            <li>Uma vez definida uma variável e dados um valor sabver que tipo é:</li>  
            
            <pre>
                $nome = "Jorge Rico"
                Write-Host $nome.GetType().name 

                PS C:\Users\MFJCode Lab> $nome = "Jorge Rico"
                Write-Host $nome.GetType().name 

                String      <strong>(Converteu automaticamente em string por que não foi explicito)</strong>
                
            </pre>
            <li>Orientação a objeto</li>
            <li>Linguagem de Alto Nível</li>

            <hr>
            <li><strong>Implicita</strong> : o tipo de dado se designa automaticamente segundo o valor que foi dado</li>
            <pre>
                $nome = "Fulano Leite"
                (A variavel $nome de designa o tipo String)

                $precio = 4.99
                (A variavel $nome de designa o tipo double)

                Exemplo:
                $nome = "Fulano Leite"
                $precio = 4.99

                Write-Host $nome.GetType().Name
                Write-Host $precio.GetType().Name

                Saida:

                PS C:\Users\MFJCode Lab>                 
                $nome = "Fulano Leite"
                $precio = 4.99

                Write-Host $nome.GetType().Name
                Write-Host $precio.GetType().Name

                String
                Double
            </pre>
            <li>Assim na definição Implicita o valor pode mudar na execução</li>

            <pre>
                $nome = "Fulano"
                Write-Host $nome.GetType().Name

                $nome = 4.99
                Write-Host $nome.GetType().Name

                saida:

                PS C:\Users\MFJCode Lab>                 
                $nome = "Fulano"
                Write-Host $nome.GetType().Name

                $nome = 4.99
                Write-Host $nome.GetType().Name

                    String
                    Double

            </pre>


            <hr>
            <li><strong>Explicito:</strong>  Definimos o tipo de dado na hora de definir a variável quando damos o valor, e se ajustará ao 
                tipo estabelecido</li>
            <pre>
                   <strong>Definição explícita</strong>
                   $temperatura = 4.99 
                   Em modo implicito será <strong>double</strong>  (64 bits) (Vai ocupar um espaço de RAM muito grande sem necessidade)

                   Mas vamos declarar de modo explicito para ser uma float (32 bits) <br>
                   [float] $temperatura = 4.99 <br>
                   Agora dependerá da natureza dos dados guardados

            </pre>

            <li>Quando uma variável tem um tipo definido e informamos um tipo de dados diferente vai saltar msg de ERRO</li>
            <pre>

                [float] $temperatura = 4.99
                $temperatura = "Agora que mudar para Caracter"

                SAIDA ERROR:

                PS C:\Users\MFJCode Lab>                 
                [float] $temperatura = 4.99
                $temperatura = "Agora que mudar para Caracter"
                Cannot convert value "Agora que mudar para Caracter" to type "System.Single". Error: "Input string was not in a correct format."
                At line:2 char:17
                +                 $temperatura = "Agora que mudar para Caracter"
                +                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                    + CategoryInfo          : MetadataError: (:) [], ArgumentTransformationMetadataException
                    + FullyQualifiedErrorId : RuntimeException


                <strong>Outro exemplo de Tipos</strong> 

                [int] $temperatura = 4.99
                write-Host $temperatura

                SAIDA (Como tipo inteiro não aceita casas decimais o valor foi arredondado)

                
                    PS C:\Users\MFJCode Lab>
                    [int] $temperatura = 4.99
                    write-Host $temperatura
                    5
                
            </pre>                      
        </ul>

        <br>

        <h2>Casting, especificar tipo de dado</h2>

        <ul>
            <li>Casting - In type casting, the compiler automatically changes one data type to another 
                one depending on what we want the program to do. </li>

        </ul>

        <pre>
            Se não especificarmos o tipo de dado neste caso abaixo vai ser armazenado como String 

            $data = "3/11/2022"
            White-Host $data

            Já neste caso vamos fazer um <strong>casting</strong>  (E NESTE CASO É POSSIVEL POR QUE É UMA sTRING QUE REPRESENTA UMA DATA )
            e agora será do tipo date.

            $data = [datetime] "3/11/2022"
            White-Host $data

            SAIDA:

            PS C:\Users\MFJCode Lab>             
            $data = "3/11/2022"
            Write-Host $data
            Write-Host $data.GetType().Name
            
            $data = [datetime] "3/11/2022"
            Write-Host $data
            Write-Host $data.GetType().Name

                        3/11/2022
                        String
                        3/11/2022 12:00:00 AM
                        DateTime

        </pre>
<hr>

<h2>Espaço ocupado em memória</h2>

<ul>
    <li>Depende do tipo de Variável</li>
    <li><strong>Longitude fixa: </strong> O tamanho da varivel na memoria não mudara, a menos que mude o dado armazenado.
        Neste grupo temos a maioria dos tipos de dados básicos: <strong>char, byte, int, long, single, double, decimal, datetime y bool.</strong> 
    </li>

    <li><strong>Longitude variável:</strong> Neste caso o tamanho da variável se ajusta ao valor que estamos atribuindo. Neste 
    grupo se encontram: <strong>string, array, hashtable e xml</strong> </li>
</ul>

<hr>

<h2>Operadores Aritiméticos</h2>

<h3>Necessidade de Operadores</h3>

<ul>
    <li>Operadores usados para transformar a informação temos a entrada, calculo e a saida</li>
    <li>Operam entre variáveis e valores fixos</li>
    <li>Devolve um valor calculado</li>
    <li>Se pode concatenar valores (com uma ordem de execução)</li>
    <li>Funcionamento dependerá do tipo de variável.</li>

</ul>

<hr>

<h2>Tipos básico de Operadores</h2>


<ul>
<li>Operadores Aritméticos</li>
<li>Operadores Lógicos</li>
<li>Operadores de Comparação</li>

</ul>

<hr>

<h2>Operador de Atribuição</h2>

<ul>
<li>Modifica o valor de uma variável</li>
<li>Pode modificar também o tipo de não está estabelecido</li>
<li>Funciona da direita para esquerda</li>
<li>O que atribui é o valor</li>
<li>Não confundir com == (esse é para comparar valores)</li>

</ul>

<pre>
    $nome_a = "Fulado de Tal"
    $nome_b = $nome_a
    $nome_a = "Ciclano de Tal"

    Write-Host $nome_a
    Write-Host $nome_b

    Que valores serão impressos?

    PS C:\Users\MFJCode Lab>     $nome_a = "Fulado de Tal"
    $nome_b = $nome_a
    $nome_a = "Ciclano de Tal"

    Write-Host $nome_a
    Write-Host $nome_b


        Ciclano de Tal
        Fulado de Tal


</pre>

<hr>

<h2>Operadores Aritméticos</h2>

<ul>
<li>Operador de Soma +</li>
    <pre>
        - Depende do tipo da variável vai atuar de uma forma ou outra
        - Não é o mesmo somar numeros ou cadeias de caracteres

        Exemplo:

        Write-Host (5+6) - Aqui apenas imprime o resultado mas não guarda na memoria
        $soma = 5 + 6 - Aqui estamos guardando o valor da soma na memoria
        Write-Host $soma - E agora estamos imprimindo

        -Soma os valores e devolve o resultado da Soma
        - Funcionamento bem claro mas cuidado com os tipos de variáveis 
        - Funciona com valores estáticos ou variáveis

        White-Host (5+6) - valor estatico

        $n = 5
        $m = 6

        $suma = $n + $m - Valor variável 
        Write-Host $suma

        SAIDA:

        PS C:\Users\MFJCode 
        
        Lab> Write-Host (5+6)

        $n = 5
        $m = 6

        $suma = $n + $m 
        Write-Host $suma

                11
                11


        <strong>OPERADOR SOMA + COM STRING </strong> 

        <strong>Concatena</strong>  as cadeias de caracteres e devolve uma cadeia com a soma das duas.

        $first_name = "Ben vindo!"
        $last_name = " Fulano de Tal"
        $full_name = $first_name + $last_name
        Write-Host $full_name

        SAIDA 

        PS C:\Users\MFJCode Lab>         
        $first_name = "Bem vindo!"
        $last_name = " Fulano de Tal"
        $full_name = $first_name + $last_name (tbm pode se colocar $first_name + " " + $last_name )
        Write-Host $full_name
        Bem vindo! Fulano de Tal

    </pre>

    <hr>

<li>Operador de subtração - </li>

<pre>
    Subtrai o valor da primeira variável e o valor da segunda varável e devolve o resultado.

    Write-Host (6-5)
    $n = 6
    $m = 5 

    $subtrai = $n - $m 
    Write-Host $subtrai

    SAIDA

    PS C:\Users\MFJCode Lab>     Write-Host (6-5)
    $n = 6
    $m = 5 

    $subtrai = $n - $m 
    Write-Host $subtrai
        1
        1

</pre>

<hr>

<li>Operador de Multiplicação * </li>

<pre>
    Multiplica o valor dos operandos e devolve o resultado



</pre>


<li>Operador de Divisão / </li>

<hr>

<li>Operador resto % </li>

<pre>



</pre>

<li>Operador += </li>
<li>Operador ++ </li>

</ul>
    
</body>
</html>